(function(e){"use strict";e.Router=Backbone.Router.extend({routes:{"user/login":"loadLogin",bookmarks:"loadLogin","user/login/:error":"loadLogin","user/register":"loadRegister",index:"loadRegister",home:"loadRegister","/":"loadRegister","":"loadRegister"},loadLogin:function(e){$("#register-form, #punch-line").fadeOut(function(){$("#login-form").fadeIn(),$(".nav-pills li.active").removeClass("active"),$(".nav-pills li.login").addClass("active"),e&&$.shout("Invalid email / password combination",10)})},loadRegister:function(){$("#login-form").fadeOut(function(){$("#register-form,  #punch-line").fadeIn(),$(".nav-pills li.active").removeClass("active"),$(".nav-pills li.home").addClass("active")})}})})(App.Routes),function(e,t,n,r,i,s){"use strict";t.Index=e.View.extend({el:s("#form-container"),events:{"submit #register-form":"registerUser"},initialize:function(){_.bindAll(this,"registerUser","render"),this.router=new r.Router,this.render()},render:function(){return this},registerUser:function(e){e.preventDefault();var t=new n.User,r=this.formToObject("register-form"),i,o;t.task="register",i=function(e,t){t.error?s.shout("Account not created, your form contains errors",10,"error"):(s("#login-email").val(e.get("email")),document.forms["register-form"].reset(),window.location.hash="#user/login",s("#bookmark-links").fadeIn(),s.shout(t.msg,15,"success"))},o=function(e,t){s.shout("Account not created, your form contains errors or you are already registered",10,"error")},t.save(r,{success:i,error:o})},formToObject:function(e){var t={},n=s("#"+e).serializeArray();return _.each(n,function(e){e.name!=="submit"&&(t[e.name]=e.value)}),t}})}(Backbone,App.Views,App.Models,App.Routes,EJS,jQuery);
